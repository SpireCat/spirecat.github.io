---
title: Fuzz Cookies
---
<p class="indent">没读懂标题的朋友先出门左拐百度/google一下fuzz和cookie的意思，不谢。</p>
<p class="indent">本文将分析**大学教务系统对于cookie的设计逻辑中不严谨的地方，获取并利用漏洞，最后分析这个漏洞的价值（危害性）。首先需要说明的是，漏洞本身并没有什么高深的地方，当然这也可能是漏洞一直存在没有被打补丁的原因。因此，我努力希望能够让不同基础的人都能读懂。</p>
<p class="indent">实际上，每一个对http消息有所了解同学都能够很轻松的发现这个漏洞。那么我们直接切入核心，对登录教务系统阶段的跳转链接抓取http消息。那么需要明确的是，登录教务系统的过程包括两条消息，其中一条为POST，另一条为GET。在了解了cookie的基础上我们可以明白，POST消息中request请求中写入学号（stuid）和口令（pwd）并递交表单，返回的response中包含了对我们<strong>十分重要</strong>的cookie值；在GET消息中，request请求填入cookie值，返回的response中包含登录反馈的消息。那么由此可以显然发现一些猫腻。也就是说，如果可以得到一个登录用户的cookie，那么就可以访问这个用户的教务系统。道理是这样讲没错...</p>
<p class="indent">那么问题来到了“获取cookie”这里。做过后台的同学应该会很清楚，cookie由服务器端分配，作为凭证保存用户信息。通过分析登录成功后的提示消息（“<i>离开时请注销</i>”&“<i>每次登录时间限为30分钟</i>”）可以大概猜测到，服务器为登录成功的用户分cookie，这个cookie的存活周期为30min，并且在用户注销登录时会销毁这个cookie。那么cookie的庐山真面目到底是什么样子的呢？现在是时候放一波图片了...</p>
<p><img src="/image/f1.png" /></p>
